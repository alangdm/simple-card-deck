{"version":3,"sources":["src/file-input.js"],"names":["LitElement","html","css","sharedStyles","FileInput","properties","highlighted","type","Boolean","reflect","styles","render","target","_handleFiles","files","_highlight","e","preventDefault","stopPropagation","_unhighlight","_drop","dataTransfer","_readFile","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","addEventListener","result","dispatchEvent","CustomEvent","promises","map","f","fileUrls","all","Event","constructor","bind","firstUpdated","document","capture","disconnectedCallback","removeEventListener","customElements","define"],"mappings":"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","sourceRoot":"/source_map/","sourcesContent":["import { LitElement, html, css } from 'lit';\r\n\r\nimport { sharedStyles } from './shared-styles.js';\r\n\r\nexport class FileInput extends LitElement {\r\n  static get properties() {\r\n    return {\r\n      highlighted: { type: Boolean, reflect: true },\r\n    };\r\n  }\r\n\r\n  static get styles() {\r\n    return [\r\n      sharedStyles,\r\n      css`\r\n        :host {\r\n          display: inline-flex;\r\n        }\r\n        :host([highlighted]) label,\r\n        :host(:focus-within) label {\r\n          border-color: var(--accent-color);\r\n        }\r\n        input {\r\n          position: fixed;\r\n          top: 0px;\r\n          left: 0px;\r\n          width: 4px;\r\n          height: 4px;\r\n          opacity: 0;\r\n          overflow: hidden;\r\n          border: none;\r\n          margin: 0;\r\n          padding: 0;\r\n          display: block;\r\n          visibility: visible;\r\n          pointer-events: none;\r\n        }\r\n        label {\r\n          display: flex;\r\n          align-items: center;\r\n        }\r\n      `,\r\n    ];\r\n  }\r\n\r\n  render() {\r\n    return html`\r\n      <label for=\"input\" class=\"button\"><slot></slot></label>\r\n      <input\r\n        id=\"input\"\r\n        type=\"file\"\r\n        multiple\r\n        accept=\"image/*\"\r\n        @change=${({ target }) => this._handleFiles(target.files)}\r\n      />\r\n    `;\r\n  }\r\n\r\n  _highlight(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.highlighted = true;\r\n  }\r\n\r\n  _unhighlight(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.highlighted = false;\r\n  }\r\n\r\n  _drop(e) {\r\n    this._handleFiles(e.dataTransfer.files);\r\n  }\r\n\r\n  _readFile(file) {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.addEventListener('loadend', () => resolve(reader.result));\r\n      reader.addEventListener('error', reject);\r\n    });\r\n  }\r\n\r\n  async _handleFiles(files) {\r\n    this.dispatchEvent(new CustomEvent('loading'));\r\n    const promises = [...files].map(f => this._readFile(f));\r\n    this.fileUrls = await Promise.all(promises);\r\n    this.dispatchEvent(new Event('change'));\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this._highlight = this._highlight.bind(this);\r\n    this._unhighlight = this._unhighlight.bind(this);\r\n    this._drop = this._drop.bind(this);\r\n  }\r\n\r\n  firstUpdated() {\r\n    document.addEventListener('dragenter', this._highlight, { capture: false });\r\n    document.addEventListener('dragover', this._highlight, { capture: false });\r\n    document.addEventListener('dragleave', this._unhighlight, {\r\n      capture: false,\r\n    });\r\n    document.addEventListener('drop', this._unhighlight, { capture: false });\r\n    document.addEventListener('drop', this._drop);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    document.removeEventListener('dragenter', this._highlight);\r\n    document.removeEventListener('dragover', this._highlight);\r\n    document.removeEventListener('dragleave', this._unhighlight);\r\n    document.removeEventListener('drop', this._unhighlight);\r\n    document.removeEventListener('drop', this._drop);\r\n  }\r\n}\r\n\r\ncustomElements.define('file-input', FileInput);\r\n"]}